<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>批量替换文件内容 - localhost/Ryekee</title>	
	<meta name="author" content="Ryekee">
	
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0">
	
	<link href='http://fonts.googleapis.com/css?family=Droid+Sans:700,400|Droid+Sans+Mono' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://blog.ryekee.com/theme/css/main.css" type="text/css" />
		
	<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	
	<link href="http://blog.ryekee.com/" type="application/atom+xml" rel="alternate" title="localhost/Ryekee ATOM Feed" />
</head>
	
<body>		
	<header class="clearfix" role="banner">
		<div class="wrapper">
			<h1 class="huge"><a href="http://blog.ryekee.com">localhost/Ryekee</a></h1>
		</div>
	</header>
	
<div role="main" class="content clearfix">	
	<article>
		<div class="post wrapper">
			<h1>批量替换文件内容</h1>
			<h1>起因</h1>
<p>昨天在邮件列表看到说有人的<code>Github</code>帐号被暴力破解了，应该就是之前的Ripple送币惹的祸。尽管我的<code>Github</code>密码复杂度不怕暴力破解，但还是去设置中开启了<a href="https://github.com/settings/admin">二次验证</a>。于是下午想提交commit的时候就喜闻乐见的告诉我被denied了，查了查都说改成SSH的方式同步可以解决，那好吧那好吧，you little bad boy my github...  </p>
<h1>解决</h1>
<p>解决方案很简单，在你的<code>repo</code>的目录下，输入：  </p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">cd</span> <span class="p">.</span><span class="n">git</span>  
<span class="err">$</span> <span class="n">vim</span> <span class="n">config</span> 
</pre></div>


<p>然后将<code>[remote "origin"]</code>标签下的<code>url</code>值改为：<br />
<code>git@github.com:[your_id]/[repo_name].git</code>  </p>
<h1>进阶解决</h1>
<p>如果你有很多很多很多很多的库（像我这样），都需要改的话，怎么办呢？一个个打开然后编辑么？清醒点哥哥，你是程序员啊！有点尊严好么！ <br />
如果你改的时候注意了一下<code>url</code>的值，你就会发现其实只不过修改了开头的部分而已。原先的为：<br />
<code>url = https://github.com/[your_id]/[repo_name].git</code><br />
修改后的是：<br />
<code>url = git@github.com:[your_id]/[repo_name].git</code><br />
因此只要将开头部分修改就好了，使用<code>find</code>、<code>grep</code>和<code>sed</code>来修改。
采用<code>find</code>来找到文件，用<code>grep</code>找到地方，最后用<code>sed</code>替换。<br />
采用的命令是：<br />
<code>$ find ~/workshop -exec grep "https://github.com/" '{}' \; -exec sed -i '' "s^https://github.com/^git@github.com:^g" {} \;</code></p>
<p>这次让我开眼界的是： <br />
1. <code>sed</code>可以使用任何字符来作为分割符号，常用的是「<code>/</code>」，但遇到「<code>/</code>」时就得替换成其他字符，甚至可以用字母；<br />
2. <code>OS X</code>下的<code>sed</code>与<code>Linux</code>下的不一样，使用了<code>-i</code>的话是强制备份的，<code>man</code>手册没有告诉你…… <br />
3. 命令行真好用……  </p>
<h3>参考</h3>
<p><a href="http://www.yayu.org/look.php?id=174">利用find和sed批量替换文件内容</a></p>
			
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
			<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
						
			<div class="comments">
			<h2>Comments !</h2>
			    <div id="disqus_thread"></div>
			    <script type="text/javascript">
			       var disqus_identifier = "replace-file-content-by-batch.html";
			       (function() {
			       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			       dsq.src = 'http://ryekee.disqus.com/embed.js';
			       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			      })();
			    </script>
			</div>
			
		</div>
	
<div class="meta wrapper">
	<time datetime="2013-11-25T12:13:00" pubdate>一 25 十一月 2013</time>
	<ul class="tag clearfix">
		<li><a href="http://blog.ryekee.com/category/tech.html">Tech</a></li>
		<li><a href="http://blog.ryekee.com/tag/git.html">git</a></li>
		<li><a href="http://blog.ryekee.com/tag/github.html">github</a></li>
		<li><a href="http://blog.ryekee.com/tag/shell.html">shell</a></li>
		<li><a href="http://blog.ryekee.com/tag/ssh.html">ssh</a></li>
		<li><a href="http://blog.ryekee.com/tag/https.html">https</a></li>
		<li><a href="http://blog.ryekee.com/tag/find.html">find</a></li>
		<li><a href="http://blog.ryekee.com/tag/sed.html">sed</a></li>
		<li><a href="http://blog.ryekee.com/tag/grep.html">grep</a></li>
	</ul>
</div>	</article>	
</div>
	
		
<footer class="clearfix">
	<div class="wrapper pages">
		<ul class="nav">
			<li><a href="http://blog.ryekee.com/archives.html">Archive</a></li>
		</ul>
	</div>
	
	<div class="copy wrapper">
		<ul class="social">
		</ul>
	
		<p role="contentinfo">© 2012 Ryekee<br>
		Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">Pelican</a>.</p>
	</div>
</footer>
	
	<script>
	  var _gaq=[['_setAccount',''],['_trackPageview']];
	  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
	  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
	  s.parentNode.insertBefore(g,s)}(document,'script'));
	</script>
</body>
</html>